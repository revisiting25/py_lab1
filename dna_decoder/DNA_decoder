import re
import matplotlib.pyplot as plt
import numpy as np
import math

data_file = 'dna_decoder/dna_raw.txt' #path for data file
sequences = []

with open(f"{data_file}", "r") as dna_file:
    for line in dna_file.readlines():
        if line[0] == ">":
            seq_id = line[1:]
            seq_dict = {
            "a": 0,
            "t": 0,
            "c": 0,
            "g": 0
            }
        else:
            line = line.strip("\n")
            line = line.strip(" ") #Probably unnessesary here
            for char in line: 
                if char.lower() in seq_dict.keys():
                    seq_dict[char.lower()] += 1 #Cumulative sum per dna character
            print(seq_id)
            print(seq_dict)
            print(" ")
            sequences.append(seq_dict)

fig = plt.figure()
i = 0
n = math.floor(math.sqrt(len(sequences))) #calculate number of rows of subplots i figure
for seq in sequences:
    ax = fig.add_subplot(int(n), int(len(sequences)/n), i + 1 )
    ax.set(title=f'seq{i+1}')
    ax = plt.bar(seq.keys(), seq.values())
    i += 1
plt.show()

